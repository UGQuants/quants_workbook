<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab 9 Multivariate linear model | UG Quantitative Methods in the Social Sciences lab workbook</title>
  <meta name="description" content="This is the workbook you will use for the Quantitative Methods in the Social Sciences lab sessions." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab 9 Multivariate linear model | UG Quantitative Methods in the Social Sciences lab workbook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the workbook you will use for the Quantitative Methods in the Social Sciences lab sessions." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab 9 Multivariate linear model | UG Quantitative Methods in the Social Sciences lab workbook" />
  
  <meta name="twitter:description" content="This is the workbook you will use for the Quantitative Methods in the Social Sciences lab sessions." />
  

<meta name="author" content="by J Rafael Verudzco Torres and Mark Wong" />


<meta name="date" content="2024-12-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-lm.html"/>
<link rel="next" href="interpretivereport.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UG Quantitative Methods in the Social Sciences: Workbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="lab-intro.html"><a href="lab-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="lab-intro.html"><a href="lab-intro.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="lab-intro.html"><a href="lab-intro.html#r-a-flexible-tool"><i class="fa fa-check"></i><b>1.1.1</b> R: a flexible tool</a></li>
<li class="chapter" data-level="1.1.2" data-path="lab-intro.html"><a href="lab-intro.html#advantages-of-using-r"><i class="fa fa-check"></i><b>1.1.2</b> Advantages of using R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="lab-intro.html"><a href="lab-intro.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lab-intro.html"><a href="lab-intro.html#setting-up-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="1.2.2" data-path="lab-intro.html"><a href="lab-intro.html#rstudio-environment"><i class="fa fa-check"></i><b>1.2.2</b> RStudio environment</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lab-intro.html"><a href="lab-intro.html#hands-on-r"><i class="fa fa-check"></i><b>1.3</b> Hands on R</a></li>
<li class="chapter" data-level="1.4" data-path="lab-intro.html"><a href="lab-intro.html#activity"><i class="fa fa-check"></i><b>1.4</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab2.html"><a href="lab2.html"><i class="fa fa-check"></i><b>2</b> Data in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lab2.html"><a href="lab2.html#welcome-back"><i class="fa fa-check"></i><b>2.1</b> Welcome back!</a></li>
<li class="chapter" data-level="2.2" data-path="lab2.html"><a href="lab2.html#learn-packages"><i class="fa fa-check"></i><b>2.2</b> R Packages</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lab2.html"><a href="lab2.html#installing-packages"><i class="fa fa-check"></i><b>2.2.1</b> Installing packages</a></li>
<li class="chapter" data-level="2.2.2" data-path="lab2.html"><a href="lab2.html#activity-1"><i class="fa fa-check"></i><b>2.2.2</b> Activity:</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lab2.html"><a href="lab2.html#types-of-variables"><i class="fa fa-check"></i><b>2.3</b> Types of variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="lab2.html"><a href="lab2.html#activity-2"><i class="fa fa-check"></i><b>2.3.1</b> Activity:</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lab2.html"><a href="lab2.html#more-operators-and-some-essential-symbols"><i class="fa fa-check"></i><b>2.4</b> More operators and some essential symbols</a></li>
<li class="chapter" data-level="2.5" data-path="lab2.html"><a href="lab2.html#black-lives-matter"><i class="fa fa-check"></i><b>2.5</b> Black lives matter!</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="lab2.html"><a href="lab2.html#downloading-and-reading-the-data"><i class="fa fa-check"></i><b>2.5.1</b> Downloading and reading the data</a></li>
<li class="chapter" data-level="2.5.2" data-path="lab2.html"><a href="lab2.html#examining-the-data"><i class="fa fa-check"></i><b>2.5.2</b> Examining the data</a></li>
<li class="chapter" data-level="2.5.3" data-path="lab2.html"><a href="lab2.html#data-wrangling"><i class="fa fa-check"></i><b>2.5.3</b> Data wrangling</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="lab2.html"><a href="lab2.html#activities"><i class="fa fa-check"></i><b>2.6</b> Activities</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>3</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#importing-and-data-wrangling"><i class="fa fa-check"></i><b>3.1</b> Importing and data wrangling</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#downloading-and-reading-the-data-1"><i class="fa fa-check"></i><b>3.1.1</b> Downloading and reading the data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-wrangling-2"><i class="fa fa-check"></i><b>3.2</b> Data wrangling</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#read-the-clean-dataset"><i class="fa fa-check"></i><b>3.3</b> Read the clean dataset</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#activity-3"><i class="fa fa-check"></i><b>3.3.1</b> Activity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#getting-started-1"><i class="fa fa-check"></i><b>4.1</b> Getting started</a></li>
<li class="chapter" data-level="4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exploratory-analysis"><i class="fa fa-check"></i><b>4.2</b> Exploratory analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-overview"><i class="fa fa-check"></i><b>4.2.1</b> Data overview</a></li>
<li class="chapter" data-level="4.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#categorical-data"><i class="fa fa-check"></i><b>4.2.2</b> Categorical data</a></li>
<li class="chapter" data-level="4.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#activity-1-1"><i class="fa fa-check"></i><b>4.2.3</b> Activity 1</a></li>
<li class="chapter" data-level="4.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#continuous-numeric-data"><i class="fa fa-check"></i><b>4.2.4</b> Continuous (numeric) data</a></li>
<li class="chapter" data-level="4.2.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#putting-it-all-together"><i class="fa fa-check"></i><b>4.2.5</b> Putting it all together</a></li>
<li class="chapter" data-level="4.2.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#activity-2-1"><i class="fa fa-check"></i><b>4.2.6</b> Activity 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>5</b> Reporting in R Markdown</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#r-markdown"><i class="fa fa-check"></i><b>5.2</b> R Markdown</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#first-r-markdown-document"><i class="fa fa-check"></i><b>5.2.1</b> First R Markdown document</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="rmarkdown.html"><a href="rmarkdown.html#activity-4"><i class="fa fa-check"></i><b>5.3</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html"><i class="fa fa-check"></i><b>6</b> Visual exploratory analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#data-visualization"><i class="fa fa-check"></i><b>6.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#prepare-the-rmd-document-and-data"><i class="fa fa-check"></i><b>6.2.1</b> Prepare the Rmd document and data</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#categorical-variables"><i class="fa fa-check"></i><b>6.3</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#bivariate-categorical-vs-categorical"><i class="fa fa-check"></i><b>6.3.1</b> Bivariate categorical vs categorical</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#numeric-variables"><i class="fa fa-check"></i><b>6.4</b> Numeric variables</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#univariate-numeric"><i class="fa fa-check"></i><b>6.4.1</b> Univariate numeric</a></li>
<li class="chapter" data-level="6.4.2" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#bivariate-numeric"><i class="fa fa-check"></i><b>6.4.2</b> Bivariate numeric</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#mixed-data"><i class="fa fa-check"></i><b>6.5</b> Mixed data</a></li>
<li class="chapter" data-level="6.6" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#activity-5"><i class="fa fa-check"></i><b>6.6</b> Activity</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="visual-exploratory-analysis.html"><a href="visual-exploratory-analysis.html#r-cheatsheets"><i class="fa fa-check"></i><b>6.6.1</b> R Cheatsheets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>7</b> Correlation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="correlation.html"><a href="correlation.html#what-is-correlation"><i class="fa fa-check"></i><b>7.1</b> What is correlation?</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="correlation.html"><a href="correlation.html#data-and-r-environment"><i class="fa fa-check"></i><b>7.1.1</b> Data and R environment</a></li>
<li class="chapter" data-level="7.1.2" data-path="correlation.html"><a href="correlation.html#visualizing-correlation"><i class="fa fa-check"></i><b>7.1.2</b> Visualizing correlation</a></li>
<li class="chapter" data-level="7.1.3" data-path="correlation.html"><a href="correlation.html#activity-1-2"><i class="fa fa-check"></i><b>7.1.3</b> Activity 1</a></li>
<li class="chapter" data-level="7.1.4" data-path="correlation.html"><a href="correlation.html#activity-2-2"><i class="fa fa-check"></i><b>7.1.4</b> Activity 2</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="correlation.html"><a href="correlation.html#measuring-correlation"><i class="fa fa-check"></i><b>7.2</b> Measuring correlation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="correlation.html"><a href="correlation.html#activity-3-1"><i class="fa fa-check"></i><b>7.2.1</b> Activity 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simple-lm.html"><a href="simple-lm.html"><i class="fa fa-check"></i><b>8</b> Linear model: Simple linear regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simple-lm.html"><a href="simple-lm.html#welcome"><i class="fa fa-check"></i><b>8.1</b> Welcome</a></li>
<li class="chapter" data-level="8.2" data-path="simple-lm.html"><a href="simple-lm.html#introduction-to-simple-linear-regression"><i class="fa fa-check"></i><b>8.2</b> Introduction to simple linear regression</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simple-lm.html"><a href="simple-lm.html#the-idea-behind"><i class="fa fa-check"></i><b>8.2.1</b> The idea behind</a></li>
<li class="chapter" data-level="8.2.2" data-path="simple-lm.html"><a href="simple-lm.html#formal-specification"><i class="fa fa-check"></i><b>8.2.2</b> Formal specification</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simple-lm.html"><a href="simple-lm.html#fitting-linear-regression-in-r"><i class="fa fa-check"></i><b>8.3</b> Fitting linear regression in R</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simple-lm.html"><a href="simple-lm.html#r-syntax"><i class="fa fa-check"></i><b>8.3.1</b> R syntax</a></li>
<li class="chapter" data-level="8.3.2" data-path="simple-lm.html"><a href="simple-lm.html#running-a-simple-linear-regression"><i class="fa fa-check"></i><b>8.3.2</b> Running a simple linear regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="simple-lm.html"><a href="simple-lm.html#interpreting-results"><i class="fa fa-check"></i><b>8.3.3</b> Interpreting results</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simple-lm.html"><a href="simple-lm.html#model-evaluation"><i class="fa fa-check"></i><b>8.4</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simple-lm.html"><a href="simple-lm.html#model-summary"><i class="fa fa-check"></i><b>8.4.1</b> Model summary</a></li>
<li class="chapter" data-level="8.4.2" data-path="simple-lm.html"><a href="simple-lm.html#further-checks"><i class="fa fa-check"></i><b>8.4.2</b> Further checks</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simple-lm.html"><a href="simple-lm.html#lab-activities"><i class="fa fa-check"></i><b>8.5</b> Lab activities</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multi-lm.html"><a href="multi-lm.html"><i class="fa fa-check"></i><b>9</b> Multivariate linear model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="multi-lm.html"><a href="multi-lm.html#introduction-2"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="multi-lm.html"><a href="multi-lm.html#multivariate-model"><i class="fa fa-check"></i><b>9.2</b> Multivariate model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="multi-lm.html"><a href="multi-lm.html#paralell-slopes"><i class="fa fa-check"></i><b>9.2.1</b> Paralell slopes</a></li>
<li class="chapter" data-level="9.2.2" data-path="multi-lm.html"><a href="multi-lm.html#multivariate-model-specification"><i class="fa fa-check"></i><b>9.2.2</b> Multivariate model specification</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="multi-lm.html"><a href="multi-lm.html#r-syntax-for-the-multivariate-linear-model"><i class="fa fa-check"></i><b>9.3</b> R syntax for the multivariate linear model</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="multi-lm.html"><a href="multi-lm.html#model-evaluation-1"><i class="fa fa-check"></i><b>9.3.1</b> Model evaluation</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="multi-lm.html"><a href="multi-lm.html#assumptions"><i class="fa fa-check"></i><b>9.4</b> Assumptions</a></li>
<li class="chapter" data-level="9.5" data-path="multi-lm.html"><a href="multi-lm.html#lab-activities-1"><i class="fa fa-check"></i><b>9.5</b> Lab activities</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="interpretivereport.html"><a href="interpretivereport.html"><i class="fa fa-check"></i><b>10</b> UG Quants summative assessment: Interpreting Quantitative Findings Report</a>
<ul>
<li class="chapter" data-level="10.1" data-path="interpretivereport.html"><a href="interpretivereport.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="interpretivereport.html"><a href="interpretivereport.html#create-your-research-report-template-from-github"><i class="fa fa-check"></i><b>10.2</b> Create your research report template from GitHub</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="interpretivereport.html"><a href="interpretivereport.html#rstudio-cloud-version"><i class="fa fa-check"></i><b>10.2.1</b> RStudio Cloud version</a></li>
<li class="chapter" data-level="10.2.2" data-path="interpretivereport.html"><a href="interpretivereport.html#rstudio-desktop-version"><i class="fa fa-check"></i><b>10.2.2</b> RStudio Desktop version</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="interpretivereport.html"><a href="interpretivereport.html#about-the-research-report-template"><i class="fa fa-check"></i><b>10.3</b> About the research report template</a></li>
<li class="chapter" data-level="10.4" data-path="interpretivereport.html"><a href="interpretivereport.html#activity-1-3"><i class="fa fa-check"></i><b>10.4</b> Activity 1</a></li>
<li class="chapter" data-level="10.5" data-path="interpretivereport.html"><a href="interpretivereport.html#activity-2-3"><i class="fa fa-check"></i><b>10.5</b> Activity 2</a></li>
<li class="chapter" data-level="10.6" data-path="interpretivereport.html"><a href="interpretivereport.html#conclusion"><i class="fa fa-check"></i><b>10.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="answers.html"><a href="answers.html"><i class="fa fa-check"></i>Workbook suggested answers</a>
<ul>
<li class="chapter" data-level="" data-path="answers.html"><a href="answers.html#introduction-4"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="answers.html"><a href="answers.html#lab-3.-data-wrangling"><i class="fa fa-check"></i>Lab 3. Data wrangling</a></li>
<li class="chapter" data-level="" data-path="answers.html"><a href="answers.html#lab-4.-exploratory-data-analysis"><i class="fa fa-check"></i>Lab 4. Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="answers.html"><a href="answers.html#activity-1-4"><i class="fa fa-check"></i><b>10.6.1</b> Activity #1</a></li>
<li class="chapter" data-level="10.6.2" data-path="answers.html"><a href="answers.html#activity-2-4"><i class="fa fa-check"></i><b>10.6.2</b> Activity #2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="answers.html"><a href="answers.html#lab-6.-visual-exploratory-analysis"><i class="fa fa-check"></i>Lab 6. Visual exploratory analysis</a>
<ul>
<li class="chapter" data-level="10.6.3" data-path="answers.html"><a href="answers.html#excercices"><i class="fa fa-check"></i><b>10.6.3</b> Excercices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="answers.html"><a href="answers.html#lab-7.-correlation"><i class="fa fa-check"></i>Lab 7. Correlation</a>
<ul>
<li class="chapter" data-level="10.6.4" data-path="answers.html"><a href="answers.html#activity-1-5"><i class="fa fa-check"></i><b>10.6.4</b> Activity 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="answers.html"><a href="answers.html#lab-8.-linear-model.-simple-linear-regression"><i class="fa fa-check"></i>Lab 8. Linear model. Simple linear regression</a>
<ul>
<li class="chapter" data-level="10.6.5" data-path="answers.html"><a href="answers.html#lab-activities-2"><i class="fa fa-check"></i><b>10.6.5</b> Lab activities</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="answers.html"><a href="answers.html#lab-9.-multivariate-linear-model"><i class="fa fa-check"></i>Lab 9. Multivariate linear model</a>
<ul>
<li class="chapter" data-level="10.6.6" data-path="answers.html"><a href="answers.html#lab-activities-3"><i class="fa fa-check"></i><b>10.6.6</b> Lab activities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html"><i class="fa fa-check"></i>Appendix 1: RMarkdown &amp; the Interpretive Report Template</a>
<ul>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#introduction-5"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown"><i class="fa fa-check"></i>RMarkdown</a>
<ul>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#formatting"><i class="fa fa-check"></i>Formatting</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#line-spacing"><i class="fa fa-check"></i>Line spacing</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#code-chunks"><i class="fa fa-check"></i>Code Chunks</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#running-code-chunks"><i class="fa fa-check"></i>Running Code Chunks</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#knitting-rmarkdown-documents"><i class="fa fa-check"></i>Knitting RMarkdown Documents</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#rmarkdown-cheat-sheet"><i class="fa fa-check"></i>RMarkdown Cheat Sheet</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#interpretive-report-template"><i class="fa fa-check"></i>Interpretive Report Template</a>
<ul>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#yaml-block"><i class="fa fa-check"></i>YAML Block</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#setup-code-chunk"><i class="fa fa-check"></i>Setup Code Chunk</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#preamble-code-chunk"><i class="fa fa-check"></i>Preamble Code Chunk</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#word-count-code"><i class="fa fa-check"></i>Word Count Code</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#template-outline"><i class="fa fa-check"></i>Template Outline</a></li>
<li class="chapter" data-level="" data-path="InterpretiveReportTemplate.html"><a href="InterpretiveReportTemplate.html#regression-results-code-chunk"><i class="fa fa-check"></i>Regression Results Code Chunk</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html"><i class="fa fa-check"></i>Appendix 2: R Issues FAQ</a>
<ul>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#introduction-6"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#reporting-r-issues"><i class="fa fa-check"></i>Reporting R Issues</a></li>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#regression-results-table-issues"><i class="fa fa-check"></i>Regression Results Table Issues</a></li>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#object-nilt_subset-not-found"><i class="fa fa-check"></i>Object ‘nilt_subset’ Not Found</a></li>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#wrong-word-count"><i class="fa fa-check"></i>Wrong Word Count</a></li>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#unable-to-knit"><i class="fa fa-check"></i>Unable to Knit</a>
<ul>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#package-could-not-be-loaded"><i class="fa fa-check"></i>Package could not be loaded</a></li>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#execution-halted"><i class="fa fa-check"></i>Execution Halted</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="RFAQ.html"><a href="RFAQ.html#turnitin-unable-to-open-html-file"><i class="fa fa-check"></i>Turnitin Unable to Open HTML File</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">UG Quantitative Methods in the Social Sciences lab workbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multi-lm" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Lab 9</span> Multivariate linear model<a href="multi-lm.html#multi-lm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Introduction<a href="multi-lm.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the last lab we mentioned that one of the advantages of linear regression is that we can include more than one independent (explanatory) variable to evaluate their relationship with the dependent variable. This technique is known as multivariate linear regression. In practice, few studies in quantitative social research rely only on simple linear models. This is because often in reality there is more than one variable associated to a social phenomenon. This is why it is important to familiarise yourself with the multivariate linear model.</p>
</div>
<div id="multivariate-model" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Multivariate model<a href="multi-lm.html#multivariate-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The multivariate linear model is based on the same principles as the simple linear model. It is worth remembering that this model is appropriate only when we have a numeric (interval/ratio) dependent variable. As a rule-of-thumb, a variable can be treated as numeric when you have at least 7 ordered categories (Fogarty, 2019). As mentioned before, we can use any type of independent variables, such as ordinal, categorical and numeric. More than one and a combination of these can be analysed simultaneously.</p>
<div id="paralell-slopes" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Paralell slopes<a href="multi-lm.html#paralell-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will follow-up with the example we used before introducing the simple linear model to further illustrate the advantages of using more than one variable. To do so, please set your RStudio environment as follows:</p>
<ol style="list-style-type: decimal">
<li>Go to your ‘Quants lab group’ in <a href="https://rstudio.cloud/">RStudio Cloud</a>;</li>
<li>Open your own ‘NILT2’ project from your ‘Quants lab group’;</li>
<li>Once in the project, create a new R Script file (a simple R Script, NOT an <code>.Rmd</code> file).</li>
<li>Save the script document as ‘multivariate_linear_model’.</li>
</ol>
<p>Reproduce the code below, by copying, pasting and running it from your new script.</p>
<p>First, install the <code>moderndive</code>package.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="multi-lm.html#cb98-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;moderndive&quot;</span>)</span></code></pre></div>
<p>Load the <code>tidyverse</code> and <code>moderndive</code> libraries (<code>tidyverse</code> was pre-installed for you before, you do not need to re-install it in this project) and read the <code>nilt_r_object.rds</code> file which is stored in the ‘data’ folder and contains the NILT survey.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="multi-lm.html#cb99-1" tabindex="-1"></a><span class="do">## Load the packages</span></span>
<span id="cb99-2"><a href="multi-lm.html#cb99-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb99-3"><a href="multi-lm.html#cb99-3" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb99-4"><a href="multi-lm.html#cb99-4" tabindex="-1"></a></span>
<span id="cb99-5"><a href="multi-lm.html#cb99-5" tabindex="-1"></a><span class="co"># Read the data from the .rds file</span></span>
<span id="cb99-6"><a href="multi-lm.html#cb99-6" tabindex="-1"></a>nilt <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/nilt_r_object.rds&quot;</span>)</span></code></pre></div>
<p>Once again, create a minimal random sample for the following example using the code below:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="multi-lm.html#cb100-1" tabindex="-1"></a><span class="co"># select a small random sample</span></span>
<span id="cb100-2"><a href="multi-lm.html#cb100-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb100-3"><a href="multi-lm.html#cb100-3" tabindex="-1"></a><span class="co"># Filter where partner&#39;s age is not NA and take a random sample of 40</span></span>
<span id="cb100-4"><a href="multi-lm.html#cb100-4" tabindex="-1"></a>nilt_sample <span class="ot">&lt;-</span> <span class="fu">filter</span>(nilt, <span class="sc">!</span><span class="fu">is.na</span>(spage)) <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">40</span>)</span>
<span id="cb100-5"><a href="multi-lm.html#cb100-5" tabindex="-1"></a><span class="co"># Select only respondent&#39;s age and spouse/partner&#39;s age</span></span>
<span id="cb100-6"><a href="multi-lm.html#cb100-6" tabindex="-1"></a>nilt_sample <span class="ot">&lt;-</span> <span class="fu">select</span>(nilt_sample, rage, spage, rsex)</span></code></pre></div>
<p>As a follow-up, we will draw a scatter plot using <code>ggplot</code> specifying the age of the respondent <code>rage</code> on the X axis and the respondent’s partner/spouse age <code>spage</code> on the Y axis. This time, we will add sex <code>rsex</code> as a third variable defining the <code>color</code> argument.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="multi-lm.html#cb101-1" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb101-2"><a href="multi-lm.html#cb101-2" tabindex="-1"></a><span class="fu">ggplot</span>(nilt_sample,  <span class="fu">aes</span>(<span class="at">x =</span> rage, <span class="at">y =</span> spage, <span class="at">color =</span> rsex)) <span class="sc">+</span> </span>
<span id="cb101-3"><a href="multi-lm.html#cb101-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="sc">+</span></span>
<span id="cb101-4"><a href="multi-lm.html#cb101-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Respondent&#39;s age vs respondent’s spouse/partner age&quot;</span>, </span>
<span id="cb101-5"><a href="multi-lm.html#cb101-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Respondent&#39;s age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Respondent’s spouse/partner age&quot;</span> )</span></code></pre></div>
<p><img src="lab-workbook_files/figure-html/unnamed-chunk-102-1.png" width="100%" style="display: block; margin: auto auto auto 0;" />
What do you observe in the plot above? …</p>
<p>The first thing to note is that females and males go in the same direction. When the respondent’s age increases the age of the partner increases as well. An interesting thing is that females tend to be located higher with respect to the Y axis compared to the male dots.</p>
<p>Therefore, we can imagine that not only the age of the respondent is involved in the decision on how people choose their partner, but also the respondents’ sex. We can draw two lines, one for male and the other for female respondents, instead of only a general one as we did in the previous lab. To do this we will use the <code>ggplot</code> function in combination with the <code>geom_parallel_slopes</code> function from the <code>moderndive</code> package:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="multi-lm.html#cb102-1" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb102-2"><a href="multi-lm.html#cb102-2" tabindex="-1"></a><span class="fu">ggplot</span>(nilt_sample,  <span class="fu">aes</span>(<span class="at">x =</span> rage, <span class="at">y =</span> spage, <span class="at">color =</span> rsex)) <span class="sc">+</span> </span>
<span id="cb102-3"><a href="multi-lm.html#cb102-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-4"><a href="multi-lm.html#cb102-4" tabindex="-1"></a>  <span class="fu">geom_parallel_slopes</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-5"><a href="multi-lm.html#cb102-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Respondent&#39;s age vs respondent’s spouse/partner age&quot;</span>, </span>
<span id="cb102-6"><a href="multi-lm.html#cb102-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Respondent&#39;s age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Respondent’s spouse/partner age&quot;</span> )</span></code></pre></div>
<p><img src="lab-workbook_files/figure-html/unnamed-chunk-103-1.png" width="100%" style="display: block; margin: auto auto auto 0;" />
Well, our suspicion that the points representing female respondents were generally above the male ones is turning out to be true. What we have in the plot above are the optimal parallel lines that describe our points the best for each group. The interpretation of our visualizations so far is:</p>
<ol style="list-style-type: decimal">
<li>both males and females partner’s age is positively associated with respondent’s age.</li>
<li>This association is different for males and females. Overall, females choose older partners compared to males.</li>
</ol>
<p>But what is the magnitude of these relationships? We can easily extend the simple linear model by adding <code>rsex</code> as a second explanatory variable as follows:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="multi-lm.html#cb103-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(spage <span class="sc">~</span> rage <span class="sc">+</span> rsex, nilt_sample)</span>
<span id="cb103-2"><a href="multi-lm.html#cb103-2" tabindex="-1"></a>m1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = spage ~ rage + rsex, data = nilt_sample)
## 
## Coefficients:
## (Intercept)         rage   rsexFemale  
##      1.7383       0.9138       4.9190</code></pre>
<p>From the output, we see that there is one intercept <span class="math inline">\(\beta_0\)</span>, one slope coefficient <span class="math inline">\(\beta_1\)</span> for the numeric variable <code>rage</code>, and another coefficient <span class="math inline">\(\beta_2\)</span> for the categorical variable. If you observe closer, the output appended only one of the two categories for <code>rsex</code>. This is because categorical variables take one of the categories as the reference. The variable that is not shown is the reference, ‘Male’, in this case.</p>
<p>Being more precise with our previous interpretation, we can say there is a positive relationship between both males and female participants’ age and their partner’s age by a factor of 0.91 for every additional year in age. Also, female respondent’s partners are expected to be 4.9 years older compared to male respondents.</p>
<p>Before we move on, it is worth mentioning that the criterion to fit the coefficient is the same as in the linear model. This procedure guarantees to produce the smallest possible sum of squared residuals (SSR) using the ordinary least square method (OLS). We can check if the SSR was reduced by adding this extra variable by computing the SSR as we did before:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="multi-lm.html#cb105-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">residuals</span>(m1) <span class="sc">^</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 948.263</code></pre>
<p>Yes, it improved! Before, it was about 1,175, as we saw in the last lab workbook.</p>
</div>
<div id="multivariate-model-specification" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Multivariate model specification<a href="multi-lm.html#multivariate-model-specification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After the introduction of the simple linear model, the formal definition of the multivariate linear model should not look that scary, right? In essence, this equation tells us how <span class="math inline">\(\hat{y}\)</span> is described/explained by other variables.</p>
<p><span class="math display">\[
\begin{aligned}
\hat{y} = \hat{\beta_0} + \hat{\beta_1}*x_1 + \hat{\beta_2}*x_2 + ... +  \hat{\epsilon}, &amp;&amp; \epsilon ~ N(0, \sigma)  
\end{aligned}
\]</span></p>
<p>We can break down the equation above in smaller pieces as follows:</p>
<ul>
<li><span class="math inline">\(\hat{y}\)</span> is the dependent variable, which is explained by</li>
<li><span class="math inline">\(\hat{\beta_0}\)</span> the intercept, plus</li>
<li><span class="math inline">\(\hat{\beta_1}\)</span> the slope coefficient for the first independent variable times the value of <span class="math inline">\(x_1\)</span> variable 1, plus</li>
<li><span class="math inline">\(\hat{\beta_2}\)</span> the slope coefficient for the second independent variable times the value of <span class="math inline">\(x_2\)</span>, plus</li>
<li><span class="math inline">\(...\)</span> any number of independent variables, plus</li>
<li><span class="math inline">\(\hat{\epsilon}\)</span> the error/residual term.</li>
<li><span class="math inline">\(\epsilon ~ N(0, \sigma)\)</span> this bit tell us that the residuals are normally distributed.</li>
</ul>
</div>
</div>
<div id="r-syntax-for-the-multivariate-linear-model" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> R syntax for the multivariate linear model<a href="multi-lm.html#r-syntax-for-the-multivariate-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(You don’t need to reproduce the code of this section in your script).</p>
<p>The general syntax in R is as follows:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="multi-lm.html#cb107-1" tabindex="-1"></a><span class="fu">lm</span>(formula, data)</span></code></pre></div>
<p>Where the formula is given by a dependent variable which is followed by <code>~</code> one or more independent variables joined by a plus sign <code>+</code>:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="multi-lm.html#cb108-1" tabindex="-1"></a>dependent_variable <span class="sc">~</span> independent_variable1 <span class="sc">+</span> independent_variable2 ...</span></code></pre></div>
<p>In the previous section, we used a small random sample of 40 people only. Now, let’s fit a multivariate linear model using all the observations in the <code>nilt</code> dataset. In addition to the respondent age <code>rage</code> and <code>rsex</code>, we might be interested to know whether the type of place where they live (e.g. big city, village, farm/country, etc.) <code>placeliv</code> plays a role in how people choose their partner.</p>
<p>First, we need to coerce the <code>placeliv</code> variable as factor. And we will have a quick look at a table of this variable to have an idea of how respondents are distributed and see how the factor levels are ordered.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="multi-lm.html#cb109-1" tabindex="-1"></a><span class="co"># Coerce to factor</span></span>
<span id="cb109-2"><a href="multi-lm.html#cb109-2" tabindex="-1"></a>nilt <span class="ot">&lt;-</span> nilt <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href="multi-lm.html#cb109-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">placeliv =</span> <span class="fu">as_factor</span>(placeliv))</span>
<span id="cb109-4"><a href="multi-lm.html#cb109-4" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb109-5"><a href="multi-lm.html#cb109-5" tabindex="-1"></a><span class="fu">table</span>(nilt<span class="sc">$</span>placeliv)</span></code></pre></div>
<pre><code>## 
##                              Dont know                          ...a big city 
##                                      0                                    168 
## the suburbs or outskirts of a big city                   a small city or town 
##                                    233                                    477 
##                      a country village          a farm or home in the country 
##                                    176                                    146</code></pre>
<p>We see that most of the respondents live in ‘a small city or town’. Also, note that the category ‘Dont know’ contains 0 observations. Let’s use the function <code>droplevels()</code> to remove the unused category in our variables. This also means that the first level in this variable will be ‘a big city’. Then, we will fit the model and store it in an object called <code>m2</code>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="multi-lm.html#cb111-1" tabindex="-1"></a><span class="co"># remove unused levels</span></span>
<span id="cb111-2"><a href="multi-lm.html#cb111-2" tabindex="-1"></a>nilt <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(nilt)</span>
<span id="cb111-3"><a href="multi-lm.html#cb111-3" tabindex="-1"></a><span class="co"># boxplot</span></span>
<span id="cb111-4"><a href="multi-lm.html#cb111-4" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(spage <span class="sc">~</span> rage <span class="sc">+</span> rsex <span class="sc">+</span> placeliv, nilt)</span>
<span id="cb111-5"><a href="multi-lm.html#cb111-5" tabindex="-1"></a>m2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = spage ~ rage + rsex + placeliv, data = nilt)
## 
## Coefficients:
##                                    (Intercept)  
##                                        1.34251  
##                                           rage  
##                                        0.94147  
##                                     rsexFemale  
##                                        3.79426  
## placelivthe suburbs or outskirts of a big city  
##                                        0.02099  
##                   placeliva small city or town  
##                                       -0.71196  
##                      placeliva country village  
##                                        0.25645  
##          placeliva farm or home in the country  
##                                       -0.01280</code></pre>
<p>From the result:</p>
<ol style="list-style-type: decimal">
<li>We confirm the positive relationship between the respondent’s age and their partner by a factor of 0.94.</li>
<li>The difference in years by sex now is smaller. We see that the age of a female respondent’s partner is expected to be 3.8 years older compared to males.</li>
<li>As before, we see that the result appended the name of the categories to the <code>placeliv</code> variables. This is because it is comparing each of the categories with the category of reference, in this case, ‘a big city’. The interpretation must be in comparative terms. For instance, the age of the respondent’s partner in ‘the suburbs or outskirts of a big city’ is expected to be 0.02 years older than the partner of someone living in a ‘a big city’. Overall, the coefficients do not differ much as a function of the type of place of where they live. The largest expected difference is for people living in ‘a small city or town’, where partner’s age is expected to be -0.7 years old compared to those living in ‘a big city’.</li>
</ol>
<p>In general, our model can be expressed as:</p>
<p><span class="math display">\[ \hat{spage}_i = \hat{\beta_0} + \hat{\beta_1}*rage_i + \hat{\beta_2}*rsex_i + \hat{\beta_3} *  placeliv_i \]</span>
So, if we wanted to know the expected age of the partner of a 40 years old female who lives in a small city or town, we can use and apply the formula above:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="multi-lm.html#cb113-1" tabindex="-1"></a><span class="fl">1.34</span> <span class="sc">+</span> <span class="fl">0.94</span><span class="sc">*</span><span class="dv">40</span> <span class="sc">+</span> <span class="fl">3.80</span><span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.7</span><span class="sc">*</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] 42.04</code></pre>
<p>The expected age of a 40 year old female’s partner is, therefore, 41.7 years old.</p>
<div id="model-evaluation-1" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Model evaluation<a href="multi-lm.html#model-evaluation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can obtain more details from our model using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="multi-lm.html#cb115-1" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = spage ~ rage + rsex + placeliv, data = nilt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -34.737  -2.176  -0.139   2.214  19.530 
## 
## Coefficients:
##                                                Estimate Std. Error t value
## (Intercept)                                     1.34251    0.86727   1.548
## rage                                            0.94147    0.01202  78.311
## rsexFemale                                      3.79426    0.37761  10.048
## placelivthe suburbs or outskirts of a big city  0.02099    0.72637   0.029
## placeliva small city or town                   -0.71196    0.65391  -1.089
## placeliva country village                       0.25645    0.75903   0.338
## placeliva farm or home in the country          -0.01280    0.75787  -0.017
##                                                Pr(&gt;|t|)    
## (Intercept)                                       0.122    
## rage                                             &lt;2e-16 ***
## rsexFemale                                       &lt;2e-16 ***
## placelivthe suburbs or outskirts of a big city    0.977    
## placeliva small city or town                      0.277    
## placeliva country village                         0.736    
## placeliva farm or home in the country             0.987    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.524 on 583 degrees of freedom
##   (614 observations deleted due to missingness)
## Multiple R-squared:  0.9143, Adjusted R-squared:  0.9134 
## F-statistic:  1037 on 6 and 583 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>From the summary, we note that the 1st and 3rd quartile of residuals are symmetric (-2.18 to 2.21). This means that 50% of the estimated/predicted ages are approximately <span class="math inline">\(\pm\)</span> 2.2 years away from the observed partner’s age. Though, the minimum and the maximum residuals are not symmetric, this could be due to some extreme observed values. We can have a look to a histogram of the residuals to have a clearer idea.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="multi-lm.html#cb117-1" tabindex="-1"></a><span class="fu">hist</span>(m2<span class="sc">$</span>residuals)</span></code></pre></div>
<p><img src="lab-workbook_files/figure-html/unnamed-chunk-112-1.png" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
<p>Overall they seem normally distributed with the exception of the negative value to the left.</p>
<p>Secondly, from the summary we can see that respondent age <code>rage</code> and respondent sex <code>rsex</code> have a significant association with the dependent variable (indicated by the p-value &lt; 0.001). You can confirm this in the fourth column of the coefficients (‘Pr(&gt;|t|)’). Also, the std. error for the coefficients of this variables is small. However, the std. error for the categories of the place of where they live <code>placeliv</code> is large when compared to the estimated coefficients in the first column. In fact, when we look at the fourth column we see that the p-values are much larger than 0.05, which means that there is not a significant relationship between any of the type of places where they live and the partner’s respondent age. What this means is that the place where people live does not play a role in the age of the respondent’s partner.</p>
<p>Third, this time we see that the multiple R-squared is slightly different from the adjusted R-squared. This is because the adjusted considers the number of independent variables included in the model. This is why the adjusted r-squared is preferred for multivariate models. This shows our model explains 91.34% of the variance of the respondent’s partner age.</p>
<p>Lastly, it is important to note that even though we use the full <code>nilt</code> data set, 614 of the observations were not considered in the analysis. This is because we do not have information for these respondents. Probably some do not have a partner or preferred not to say their sex, for example.</p>
</div>
</div>
<div id="assumptions" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Assumptions<a href="multi-lm.html#assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You need to know that these estimates are backed by well-established patterns studied in probability and statistics. Therefore, the linear model, as many other statistical techniques, provides reliable estimates if the data follows certain characteristics. These are known as assumptions. We will not go into detail with these. However, it is important that you have them in mind when you evaluate your results and also evaluate others.</p>
<p>There are many assumption for the linear regression model, but we will introduce four of the most commonly assessed (Boston University School of Public Health, 2016):</p>
<ul>
<li>Linearity: The relationship between X and the mean of Y is linear.</li>
<li>Homoscedasticity: The variance of residual is the same for any value of X.</li>
<li>Independence: Observations are independent of each other.</li>
<li>Normality: For any fixed value of X, Y is normally distributed.</li>
</ul>
<p>A first step to identify potential violations of the points above is to assess the distribution of the residuals by looking to the quartiles, mean and histogram. There are many other specific tests and techniques that can help us to know whether we met the assumptions and more importantly that can help to correct them.</p>
<p>For the moment, we will leave it here. The important thing is to be aware of the existence of these potential problems and to be transparent with the results you produce. For now, I would suggest you to acknowledge the limitations of your assumptions checks.</p>
</div>
<div id="lab-activities-1" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Lab activities<a href="multi-lm.html#lab-activities-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Set an R Markdown document in your ‘NILT2’ project as following:</p>
<ol style="list-style-type: decimal">
<li>Create a new <code>Rmd</code> file, type ‘Multivariate linear model’ in ‘Tile’ section and your name in the ‘Author’ box. Leave the ‘Default Output Format’ as <code>HTML</code>.</li>
<li>Save the Rmd document as ‘Multivariate_lab’.</li>
<li>Erase all the contents in the Rmd default example with the exception of the first bit (that contains the YAML) and the first R chunk (which contains the default chunk options), that is all from line 12 and on.</li>
</ol>
<p>Using the <code>nilt</code> object do the following by inserting a new chunk for each bullet points below (remember to write the comments and observations for the results as simple text outside the chunks):</p>
<ol style="list-style-type: decimal">
<li>Load the packages, and the data that you will need in your file using the code below:</li>
</ol>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="multi-lm.html#cb118-1" tabindex="-1"></a><span class="do">## Load the packages</span></span>
<span id="cb118-2"><a href="multi-lm.html#cb118-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb118-3"><a href="multi-lm.html#cb118-3" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb118-4"><a href="multi-lm.html#cb118-4" tabindex="-1"></a><span class="co"># Read the data from the .rds file</span></span>
<span id="cb118-5"><a href="multi-lm.html#cb118-5" tabindex="-1"></a>nilt <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/nilt_r_object.rds&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Print a table for the highest level of qualification <code>highqual</code> using the <code>table()</code> function.</li>
<li>Generate a scatter plot using <code>ggplot</code>. Within <code>aes()</code>, locate the number of hours worked a week <code>rhourswk</code> on the X axis and the personal income <code>persinc2</code> on the Y axis, and specify the <code>color</code> of the dots by the highest level of qualification <code>highqual</code>. Use the <code>geom_point()</code> function and ‘jitter’ the points using the argument <code>position</code>. Add the parallel slopes using the <code>geom_parallel_slopes()</code> function and set the standard error <code>se</code> to <code>FALSE</code>. What is your interpretation of the plot? Write down your comments to introduce the plot.</li>
<li>Fit a linear model model using the <code>lm()</code> function to analyse the personal income <code>persinc2</code> using the number of works worked a week <code>rhourswk</code>, the highest level of qualification <code>highqual</code>, and the age of the respondent <code>rage</code> as independent variables. Store the model in an object called <code>m4</code> and print the summary.</li>
<li>Comment on the results of the model by mentioning which of the variables is significant and their respective p-value, the adjusted r-squared of the model, and the number of observations used to fit the model.</li>
<li>Plot a histogram of the residuals for model <code>m4</code>. Do they look normally distributed? Can we trust our estimates or would you advise to carry out further actions to verify the adequate interpretation of this model?</li>
<li>Discuss your answers with your neighbour or tutor.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-lm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interpretivereport.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["lab-workbook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
