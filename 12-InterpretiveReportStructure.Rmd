# Appendix 1: RMarkdown & the Interpretive Report Template {#InterpretiveReportTemplate .unnumbered}

## Introduction {.unnumbered}

This appendix provides additional information on using RMarkdown and the structure of RMarkdown document provided with the interpretive report project template.

Please ensure to review the relevant lab materials:

- [Lab 5 session on RMarkdown](#rmarkdown) for an intro to RMarkdown.
- [Lab 10 Session for Interpreting Quantitative Findings Report summative assessment](#interpretivereport) for instructions on how to create a project on RStudio Cloud for your interpretive report using the provided template.
 
The first half of this page provides an overview of [RMarkdown] and the second half covers the [Interpretive Report Template] in more detail. 

## RMarkdown {.unnumbered}

RMarkdown enables you to write in plain-text with [Code Chunks] by combining the power of R, markdown, and pandoc.

Markdown is a lightweight 'markup language', that uses simple easy to read syntax for formatting (see [Formatting] section below). Pandoc is a tool for converting documents from one format into another, such as markdown to PDF or HTML. RMarkdown builds on-top of this, when you 'knit' a document, all the code chunks are run, with any tables, graphs, etc created by them passed alongside the markdown text to pandoc to convert into a HTML or similar output file. The three combined, means you can focus on your text and analysis, using 'knit' to convert them into a consistently and neatly formatted output file. 

This lets you focus on the text, which pandoc will convert into consistently formatted output files. If you have ever been working on a large complexly formatted 


### Formatting

```{r echo=FALSE}
knitr::include_graphics("./images/markdownraw.png")
```

```{r echo=FALSE}
knitr::include_graphics("./images/markdownknitted.png")
```

```{r echo=FALSE}
knitr::include_graphics("./images/headingsraw.png")
```

```{r echo=FALSE}
knitr::include_graphics("./images/headingsknitted.png")
```

### Line spacing

```{r echo=FALSE}
knitr::include_graphics("./images/linespacingraw.png")
```

```{r echo=FALSE}
knitr::include_graphics("./images/linespacingknitted.png")
```

### Code Chunks

There are three main ways to create code chunk:

-   Click the 'Insert Code Chunk' button and from the drop-down select 'R' at the top. (See gif below)
-   Press `Ctrl + Alt + I` (Windows & Linux) or `Cmd + Option + I` (macOS)
-   Manually typing three back-ticks, "\`\`\`{r}", before your code and adding three back-ticks after, "\`\`\`".

```{r echo=FALSE}
knitr::include_graphics("./images/insertcodechunk.gif")
```

Curly brackets at the start of a code chunk are used to specify `{programming-language optional name, options = values}`. Since we are using R, all our code chunks have `{r ...}`. Within code chunks, the pound sign / hash, `#`, at the start of a line is used to add any comments:

```{r echo=FALSE}
knitr::include_graphics("./images/codechunk.png")
```

#### Code Chunks Labels

Adding a label is useful as a quick way to remind yourself what the purpose of each code chunk. The quick outline (button at bottom of Source panel) can be used to jump to specific sections of your document. If you provide a label for your code chunk it will also appear here:

```{r echo=FALSE}
knitr::include_graphics("./images/chunkaddingname.gif")
```

#### Code Chunk Options

Options are used to specify how code chunks are handled when run/knitted. Two key ones we have used in the labs and in the project template:

-   **echo** - whether the code chunk is displayed in knitted outputs.
-   **include** - whether the code chunk *and* its output is displayed in knitted outputs.

By default the output *and* the code chunk are displayed in knitted outputs. For the interpretive report, you do not want to display the code chunks in your knitted HTML file, so ensure to add `echo=FALSE` to the options for new code chunks you create. Also, see [Setup Code Chunk] section for information on how to set `echo=FALSE` as a 'global option'.

Examples when working in RMarkdown document:

```{r echo=FALSE}
knitr::include_graphics("./images/echoincluderaw.png")
```

And when knitted:

```{r echo=FALSE}
knitr::include_graphics("./images/echoincludeknitted.png")
```

### Running Code Chunks

```{r echo=FALSE}
knitr::include_graphics("./images/runchunk.png")
```

1.  Run Current Chunk -
2.  Run All Chunks Above -

```{r echo=FALSE}
knitr::include_graphics("./images/runoptions.png")
```

### Knitting RMarkdown Documents

```{r echo=FALSE}
knitr::include_graphics("./images/knitting.png")
```

### RMarkdown Cheat Sheet

It is possible to access an RMarkdown cheat sheet (as well as ones for ggplot2 and dplyr!) from within RStudio:

```{r echo=FALSE}
knitr::include_graphics("./images/markdowncheetsheet.gif")
```

## Interpretive Report Template {.unnumbered}

### YAML Block {.unnumbered}

```{r echo=FALSE}
knitr::include_graphics("./images/templateyaml.png")
```

To save having to remember to update the date before knitting and submitting your final version, you can use the following in the YAML block:

```         
date: "`r format(Sys.time(), '%d/%m/%y')`"
```

When knitted that code will add the current date in dd/mm/yy format (e.g. 04/12/24):

```{r echo=FALSE}
knitr::include_graphics("./images/knitteddate.png")
```

### Setup Code Chunk {.unnumbered}

```{r echo=FALSE}
knitr::include_graphics("./images/templatesetup.png")
```

```{r echo=FALSE}
knitr::include_graphics("./images/templatesetupechofalse.png")
```


### Preamble Code Chunk {.unnumbered}

It is best practice to install and load any required packages at the top of the RMarkdown file. This keeps all package management in a single location and only done once.

Recent versions of R have significantly improved handling of potential conflicts between packages. However, where packages depend on others or there are conflicts, such as both using the same names for different functions, loading the packages multiple times and in different places across your code can still create issues.

The preamble code block within the template provides a structure you can add additional packages to as needed.

```{r echo=FALSE}
knitr::include_graphics("./images/templatepreamble.png")
```

WILL NEED TO UPDATE

Outlined in blue, is a line that assigns to a vector object, 'list.of.packages', a list of packages used within the RMarkdown file. The two lines following it create another vector object, 'new.packages', with only the packages listed in 'list.of.packages' that are not already installed, then installs all packages listed in the 'new.packages' vector object.

Outlined in red, is the section that loads the tidyverse and stargazer packages.

If you require additional packages, the best way to add these would be adding them to the list assigned to 'list.of.packages' and adding a new library() line under the existing ones in the preamble. For example, if needing to install and load 'vtable':

IMAGE HERE

**Note**, moving all code for installing and loading of packages into this preamble code chunk means you do not need, and can safely remove, any other install.package() and library() lines from the rest of your code chunks.


### Word Count Code {.unnumbered}

```{r echo=FALSE}
knitr::include_graphics("./images/wordcountinline.png")
```

Note, surrounding code with single back-ticks, (/\`), creates an "inline code chunk", enabling you to add short snippets of code.

### Template Outline {.unnumbered}

```{r echo=FALSE}
knitr::include_graphics("./images/templateoutline.png")
```

### Regression Results Code Chunk {.unnumbered}

```{r echo=FALSE}
knitr::include_graphics("./images/templateresults.png")
```

### Knitted Regression Results Table {.unnumbered}

```{r echo=FALSE}
knitr::include_graphics("./images/knittedtemplate.png")
```
