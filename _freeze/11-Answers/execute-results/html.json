{
  "hash": "9c56207664f8b9062099d2478c8b48eb",
  "result": {
    "engine": "knitr",
    "markdown": "# Workbook suggested answers {#answers .unnumbered}\n\n\n\n\n\n\n\n\n\n## Introduction {.unnumbered}\n\nThis chapter presents the suggested `R` code to answer the workbook activities and exercises throughout the course labs in Quantitative Research Methods for Social Sciences. This covers from Lab 3 to Lab 9.\n\nBefore looking at the answers, try asking your tutor for help. Also, we strongly recommend web resources, such as <https://stackoverflow.com/> or <https://community.rstudio.com/>. By solving the issues, you will learn a lot! ;)\n\n## Lab 3. Data wrangling {.unnumbered}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the packages\nlibrary(tidyverse)\n\n# Read the data from the .rds file\nclean_data <- readRDS(\"data/nilt_r_object.rds\")\n# Glimpse clean_data\nglimpse(clean_data)\n\n# Glimpse the nilt data\nglimpse(nilt)\n```\n:::\n\n\n\n\n## Lab 4. Exploratory data analysis {.unnumbered}\n\nPreamble code\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the packages\nlibrary(tidyverse)\n# Read the data from the .rds file\nnilt <- readRDS(\"data/nilt_r_object.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Subset\nnilt_subset <- select(nilt, rsex, rage, highqual, religcat, uninatid, ruhappy, rhourswk, persinc2)\n```\n:::\n\n\n\n\n### Activity #1\n\nFrom your RStudio Cloud script, do the following activities using the data stored in the `nilt_subset` object:\n\n-   Create a One-Way contingency table for `uninatid` in the `nilt_subset` dataset using the `sumtable()` function;\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the vtable package to create summary tables\nlibrary(vtable)\n# Create table\nsumtable(nilt_subset, vars = c(\"uninatid\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Summary Statistics</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> uninatid </td>\n   <td style=\"text-align:left;\"> 1183 </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ... Unionist </td>\n   <td style=\"text-align:left;\"> 348 </td>\n   <td style=\"text-align:left;\"> 29% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ... Nationalist </td>\n   <td style=\"text-align:left;\"> 255 </td>\n   <td style=\"text-align:left;\"> 22% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ... Neither </td>\n   <td style=\"text-align:left;\"> 580 </td>\n   <td style=\"text-align:left;\"> 49% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n-   Using the variables `religcat` and `uninatid`, generate a Two-Way contingency table;\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsumtable(nilt_subset, vars = c(\"religcat\"), group = \"uninatid\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Summary Statistics</caption>\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">uninatid</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Unionist</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Nationalist</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Neither</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Percent </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Percent </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> religcat </td>\n   <td style=\"text-align:left;\"> 341 </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 255 </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 558 </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ... Catholic </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> 1% </td>\n   <td style=\"text-align:left;\"> 245 </td>\n   <td style=\"text-align:left;\"> 96% </td>\n   <td style=\"text-align:left;\"> 238 </td>\n   <td style=\"text-align:left;\"> 43% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ... Protestant </td>\n   <td style=\"text-align:left;\"> 305 </td>\n   <td style=\"text-align:left;\"> 89% </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> 2% </td>\n   <td style=\"text-align:left;\"> 180 </td>\n   <td style=\"text-align:left;\"> 32% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ... No religion </td>\n   <td style=\"text-align:left;\"> 34 </td>\n   <td style=\"text-align:left;\"> 10% </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> 2% </td>\n   <td style=\"text-align:left;\"> 140 </td>\n   <td style=\"text-align:left;\"> 25% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n### Activity #2\n\nUsing the data in the `nilt_subset` object, complete the following activities.\n\n-   Using the `hist()` function plot a histogram of personal income `persinc2`. From the NILT documentation this variable refers to annual personal income in Â£ before taxes and other deductions;\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(nilt_subset$persinc2)\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n-   Create a summary of the personal income `persinc2` variable, using the `sumtable()` function.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsumtable(nilt_subset, vars = c(\"persinc2\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Summary Statistics</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Mean </th>\n   <th style=\"text-align:left;\"> Std. Dev. </th>\n   <th style=\"text-align:left;\"> Min </th>\n   <th style=\"text-align:left;\"> Pctl. 25 </th>\n   <th style=\"text-align:left;\"> Pctl. 75 </th>\n   <th style=\"text-align:left;\"> Max </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> persinc2 </td>\n   <td style=\"text-align:left;\"> 897 </td>\n   <td style=\"text-align:left;\"> 16395 </td>\n   <td style=\"text-align:left;\"> 13466 </td>\n   <td style=\"text-align:left;\"> 260 </td>\n   <td style=\"text-align:left;\"> 6760 </td>\n   <td style=\"text-align:left;\"> 22100 </td>\n   <td style=\"text-align:left;\"> 75000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n-   Compute the mean and standard deviation of the personal income `persinc2`, grouped by happiness `ruhappy`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsumtable(nilt_subset, vars = c(\"persinc2\"), group = \"ruhappy\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Summary Statistics</caption>\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">ruhappy</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Very happy</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Fairly happy</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Not very happy</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Not at all happy</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Can't choose</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Mean </th>\n   <th style=\"text-align:left;\"> SD </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Mean </th>\n   <th style=\"text-align:left;\"> SD </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Mean </th>\n   <th style=\"text-align:left;\"> SD </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Mean </th>\n   <th style=\"text-align:left;\"> SD </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Mean </th>\n   <th style=\"text-align:left;\"> SD </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> persinc2 </td>\n   <td style=\"text-align:left;\"> 305 </td>\n   <td style=\"text-align:left;\"> 17569 </td>\n   <td style=\"text-align:left;\"> 13429 </td>\n   <td style=\"text-align:left;\"> 500 </td>\n   <td style=\"text-align:left;\"> 16262 </td>\n   <td style=\"text-align:left;\"> 14015 </td>\n   <td style=\"text-align:left;\"> 62 </td>\n   <td style=\"text-align:left;\"> 13445 </td>\n   <td style=\"text-align:left;\"> 9754 </td>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:left;\"> 12451 </td>\n   <td style=\"text-align:left;\"> 11501 </td>\n   <td style=\"text-align:left;\"> 15 </td>\n   <td style=\"text-align:left;\"> 11457 </td>\n   <td style=\"text-align:left;\"> 6113 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n## Lab 6. Visual exploratory analysis {.unnumbered}\n\nPreamble code\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the packages\nlibrary(tidyverse)\n\n# Load the data from the .rds file we created in the last lab\nnilt <- readRDS(\"data/nilt_r_object.rds\")\n# Create subset\nnilt_subset <- select(nilt, rsex, rage, highqual, religcat, uninatid, ruhappy, rhourswk, persinc2)\n```\n:::\n\n\n\n\n### Excercices\n\nUsing the `nilt_subset` object, complete the tasks below in the Rmd file 'Lab_4', which you created earlier. Insert a new chunk for each of these activities and include brief comments as text in the Rmd document to introduce the plots and discuss the results (tip ---leave an empty line between your text and the next chunk to separate the description and the plots):\n\n-   Create a first-level header to start a section called \"Categorical analysis\";\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Categorical analysis\n```\n:::\n\n\n\n\n-   Create a simple bar plot using the `geom_bar()` geometry to visualize the political affiliation reported by the respondents using the variable `uninatid`;\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(nilt_subset, aes(x = uninatid)) +\n  geom_bar() +\n  labs(title = \"Political afiliation\", x = \"Party\")\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n\n-   Based on the plot above, create a 'stacked bar plot' to visualize the political affiliation by religion, using the `uninatid` and `religcat` variables;\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(nilt_subset, aes(x = uninatid, fill = religcat)) +\n  geom_bar() +\n  labs(\n    title = \"Political affiliation by religion\",\n    x = \"Party\", fill = \"Religion\"\n  )\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n\n-   Create a new first-level header to start a section called \"Numeric analysis\";\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Numeric analysis\n```\n:::\n\n\n\n\n-   Create a scatter plot about the relationship between personal income `persinc2` on the Y axis and number of hours worked a week `rhourswk` on the X axis;\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(nilt_subset, aes(x = rhourswk, y = persinc2)) +\n  geom_point() +\n  labs(\n    title = \"Income and number of hours worked a week\",\n    x = \"Number of hours worked a week\", y = \"Personal income (Â£ a year)\"\n  )\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\n-   Finally, create a box plot to visualize personal income `persinc2` on the Y axis and self-reported level of happiness `ruhappy` on the x axis... Interesting result, Isn't it? Talk to your lab group-mates and tutors about your results on Zoom (live) or your Lab Group on Teams (online anytime);\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(nilt_subset, aes(x = ruhappy, y = persinc2)) +\n  geom_boxplot() +\n  labs(\n    title = \"Personal income and happiness\",\n    x = \"Happiness level\", y = \"Personal income (Â£ a year)\"\n  )\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n\n-   Briefly comment each of the plots as text in your Rmd file;\n-   Knit the .Rmd document as HTML or PDF. The knitted file will be saved automatically in your project. You can come back to the Rmd file to make changes if needed and knit it again as many times as you wish.\n\n## Lab 7. Correlation {.unnumbered}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the packages\nlibrary(tidyverse)\nlibrary(haven)\n# Load the data from the .rds file we created in lab 3\nnilt <- readRDS(\"data/nilt_r_object.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Age of respondentâs spouse/partner\nnilt$spage <- as.numeric(nilt$spage)\n# Migration\nnilt <- mutate_at(nilt, vars(mil10yrs, miecono, micultur), as.numeric)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# overall perception towards migrants\nnilt <- rowwise(nilt) %>%\n  # sum values\n  mutate(mig_per = sum(mil10yrs, miecono, micultur, na.rm = T)) %>%\n  ungroup() %>%\n  # assign NA to values that sum 0\n  mutate(mig_per = na_if(mig_per, 0))\n```\n:::\n\n\n\n\n### Activity 1\n\nUsing the `nilt` data object, visualize the relationship of the following variables by creating a new chunk. Run the chunk individually and comment on what you observe from the result as text in the Rmd file (remember to leave an empty line between your text and the chunk).\n\n-   Create a scatter plot to visualize the correlation between the respondent's overall opinion in relation to migration `mig_per` and the respondent's age `rage`. Remember that we just created the `mig_per` variable by summing three variables which were in a 0-10 scale (the higher the value, the better the person's perception is). In `aes()`, specify `rage` on the X axis and `mig_per` on the Y axis. Use the `ggplot()` function and `geom_point()`. Also, include a straight line describing the points using the `geom_smooth()` function. Within this function, set the `method` argument to `'lm'`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(nilt, aes(x = rage, mig_per)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(\n    title = \"Perception of migration vs age\",\n    x = \"Respondent age\", y = \"Perception of migration (0-30)\"\n  )\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n\n-   What type of relationship do you observe? Comment the overall result of the plot and whether this is in line with your previous expectation.\n\n## Lab 8. Linear model. Simple linear regression {.unnumbered}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the packages\nlibrary(tidyverse)\n# Read the data from the .rds file\nnilt <- readRDS(\"data/nilt_r_object.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- lm(persinc2 ~ rhourswk, data = nilt)\n```\n:::\n\n\n\n\n### Lab activities\n\nUse the `nilt` data set object in your `linear_model_intro` file to:\n\n1.  Plot a scatter plot using `ggplot`. In the aesthetics, locate `rhourswk` in the X axis, and `persinc2` in the Y axis. In the `geom_point()`, jitter the points by specifying the `position = 'jitter'`. Also, include the best fit line using the `geom_smooth()` function, and specify the `method = 'lm'` inside.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(nilt, aes(x = rhourswk, y = persinc2)) +\n  geom_point(position = \"jitter\") +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n\n2.  Print the summary of `m3` using the `summary()` function.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = persinc2 ~ rhourswk, data = nilt)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-43694  -8148  -3070   4990  58249 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   5170.4     1966.2    2.63  0.00884 ** \nrhourswk       463.2       52.4    8.84  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 13860 on 455 degrees of freedom\n  (747 observations deleted due to missingness)\nMultiple R-squared:  0.1466,\tAdjusted R-squared:  0.1447 \nF-statistic: 78.15 on 1 and 455 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n3.  Is the relationship of hours worked a week significant? Re: Yes. The p-value (fourth column of the 'Coefficients' table) is lower than 0.05.\n4.  What is the adjusted r-squared? How would you interpret it? Re: the adjusted R-squared is 0.14. This can be interpreted in terms of percentage, e.g. 14% of the variance in personal income can be explained by the number of hours worked a week.\n5.  What is the sample size to fit the model? Re: The total number of observations in the data set is 1,204 and the model summary says that 747 observations were deleted due to missingness. Therefore, the sample size is 457 (1204-747).\n6.  What is the expected income in pounds a year for a respondent who works 30 hours a week according to coefficients of this model?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n5170.4 + 463.2 * 30\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 19066.4\n```\n\n\n:::\n:::\n\n\n\n\n7.  Plot a histogram of the residuals of `m3` using the `residuals()` function inside `hist()`. Do the residuals look normally distributed (as in a bell-shaped curve)?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(residuals(m3))\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\n\nOverall, the residuals look normally distributed with the exception of the values to the right-hand side of the plot (between 40000 and 60000).\n\n## Lab 9. Multivariate linear model {.unnumbered}\n\n### Lab activities\n\n1.  Load the packages, and the data that you will need in your file using the code below:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the packages\nlibrary(moderndive)\nlibrary(tidyverse)\n# Read the data from the .rds file\nnilt <- readRDS(\"data/nilt_r_object.rds\")\n```\n:::\n\n\n\n\n2.  Print a table for the highest level of qualification `highqual` using the `table()` function.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(nilt$highqual)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nDegree level or higher       Higher education   GCE A level or equiv \n                   230                    102                    243 \n     GCSE A-C or equiv      GCSE D-G or equiv      No qualifications \n                   185                     82                    281 \n  Other, level unknown           Unclassified \n                    27                     54 \n```\n\n\n:::\n:::\n\n\n\n\n3.  Generate a scatter plot using `ggplot`. Within `aes()`, locate the number of hours worked a week `rhourswk` on the X axis and the personal income `persinc2` on the Y axis, and specify the `color` of the dots by the highest level of qualification `highqual`. Use the `geom_point()` function and 'jitter' the points using the argument `position`. Add the parallel slopes using the `geom_parallel_slopes()` function and set the standard error `se` to `FALSE`. What is your interpretation of the plot? Write down your comments to introduce the plot.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(nilt, aes(x = rhourswk, y = persinc2, color = highqual)) +\n  geom_point(position = \"jitter\") +\n  moderndive::geom_parallel_slopes(se = FALSE) +\n  labs(\n    title = \"Personal income\",\n    subtitle = \"Personal income and number of hours worked a week by education level\",\n    x = \"Number of hours worked a week\", y = \"Personal income (Â£ a year)\",\n    color = \"Highest education level\"\n  )\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n\n4.  Fit a linear model using the `lm()` function to analyse the personal income `persinc2` using the number of hours worked a week `rhourswk`, the highest level of qualification `highqual`, and the age of the respondent `rage` as independent variables. Store the model in an object called `m4` and print the summary.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm4 <- lm(persinc2 ~ rhourswk + rage + highqual, nilt)\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = persinc2 ~ rhourswk + rage + highqual, data = nilt)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-36228  -6425  -1411   4635  54749 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                    3904.64    2714.25   1.439    0.151    \nrhourswk                        444.79      45.32   9.814  < 2e-16 ***\nrage                            236.59      48.47   4.881 1.47e-06 ***\nhighqualHigher education      -8164.91    1939.50  -4.210 3.09e-05 ***\nhighqualGCE A level or equiv -12439.26    1563.42  -7.956 1.47e-14 ***\nhighqualGCSE A-C or equiv    -13037.47    1703.07  -7.655 1.20e-13 ***\nhighqualGCSE D-G or equiv    -11622.07    2665.38  -4.360 1.61e-05 ***\nhighqualNo qualifications    -12968.10    2339.78  -5.542 5.11e-08 ***\nhighqualOther, level unknown  15445.70    3334.75   4.632 4.76e-06 ***\nhighqualUnclassified         -12399.58    2786.16  -4.450 1.08e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11830 on 447 degrees of freedom\n  (747 observations deleted due to missingness)\nMultiple R-squared:  0.3887,\tAdjusted R-squared:  0.3764 \nF-statistic: 31.58 on 9 and 447 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n5.  Comment on the results of the model by mentioning which of the variables is significant and their respective p-value, the adjusted r-squared of the model, and the number of observations used to fit the model. Re: All the independent variables including the number of hours worked a week, age, and all the categories of highest qualification level compared to 'Degree or higher' are significant to predict personal income in the model 'm4', considering that the p-value is lower than 0.05. We can confirm this from the fourth column of the 'Coefficients' table. The adjusted R-squared of the model is 0.37. This means that 37.6% of the variance in personal income can be explained by these variables. The size of the sample used to fit this model is 457, considering that the 'nilt' data set contains 1204 observations but 747 were deleted due to missingness (1204 - 747).\n6.  Plot a histogram of the residuals for model `m4`. Do they look normally distributed? Can we trust our estimates or would you advise to carry out further actions to verify the adequate interpretation of this model?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(residuals(m4))\n```\n\n::: {.cell-output-display}\n![](11-Answers_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n\n\nThe distribution of the residuals in 'm4' look overall normally distributed. However, the distribution is not perfectly symmetric. Therefore, we would advice to conduct further checks to test the linear model assumptions.\n\n<!-- ## Logistic regression -->\n\n<!-- ```{r} -->\n\n<!-- ## Load the packages -->\n\n<!-- library(tidyverse) -->\n\n<!-- library(jtools) -->\n\n<!-- # Read the data from the .rds file -->\n\n<!-- nilt <- readRDS(\"data/nilt_r_object.rds\") -->\n\n<!-- ``` -->\n\n<!-- ### Lab activities -->\n\n<!-- You will explore the interreligious relations in Northern Ireland measured by the acceptance of a close relative marrying someone of a different religion in the variable `smarrrlg`. This variable asks _Would you mind or not mind if one of your close relatives were to marry someone of a different religion?_. The possible answers are three: _1 Would mind a lot_ / _2 Would mind a little_ / _3 Would not mind_. -->\n\n<!-- Using the `nilt` object complete the following activities in your `logit_model.R` R Script: -->\n\n<!-- 1. Coerce the variable `smarrrlg` to factor using the `as_factor()` function. -->\n\n<!-- ```{r} -->\n\n<!-- nilt$smarrrlg <- as_factor(nilt$smarrrlg) -->\n\n<!-- ``` -->\n\n<!-- 2. Print a simple table of this variable using the `table()` function. -->\n\n<!-- ```{r} -->\n\n<!-- table(nilt$smarrrlg) -->\n\n<!-- ``` -->\n\n<!-- 3. From the three possible options, create a new binary variable called `marr_mix` using the `ifelse()` function. Assign '1' if the response is _Would mind a lot_ or _2 Would mind a little_ and '0' otherwise. You can copy and run the code below. -->\n\n<!-- ```{r} -->\n\n<!-- nilt$marr_mix <- ifelse(nilt$smarrrlg == 'Would mind a lot' | nilt$smarrrlg == 'Would mind a little', 1, 0) -->\n\n<!-- ``` -->\n\n<!-- 4. Create a stacked bar plot using `ggplot()`, in `aes()` set `marr_mix` in the x axis, and `fill` to `religcat`. Use the `geom_bar()` function, and within this specify the `position` argument to 'fill'. Filter out the missing values for `marr_mix` before passing the data to ggplot. -->\n\n<!-- ```{r} -->\n\n<!-- nilt %>%  -->\n\n<!--   filter(!is.na(marr_mix)) %>%  -->\n\n<!--   ggplot(aes(x= marr_mix, fill = religcat)) + -->\n\n<!--     geom_bar(position = 'fill') -->\n\n<!-- ``` -->\n\n<!-- 5. Fit a logit model using the `marr_mix` as the dependent variable, `persinc2` and `religcat` as the independent variables. Assign it to and object called `m9`. -->\n\n<!-- ```{r} -->\n\n<!-- m9 <- glm(marr_mix ~ persinc2 + religcat, data = nilt, family = 'binomial') -->\n\n<!-- ``` -->\n\n<!-- 6. Use the `jtools::summ()` function to print the summary of the results, setting the `exp` argument to `TRUE`. -->\n\n<!-- ```{r} -->\n\n<!-- jtools::summ(m9, exp = TRUE) -->\n\n<!-- ``` -->\n\n<!-- 7. Which of the independent variables is/are significant?  -->\n\n<!-- Re: From the results of 'm9', personal income and being protestant are significant to study who is more likely to mind if a respondent's close relative were to marry someone of a different religion. -->\n\n<!-- 8. Do you think personal income is playing a role? -->\n\n<!-- Re: Although personal income p-value is equal to 0.05, which can be consider as significant, we cannot expect this is playing a role, since the odds ratio are the same regardless of changes in personal income. We can confirm this from the first column of the coefficients table (persinc2 = 1). -->\n\n<!-- 9. How do you interpret the coefficient for protestant respondents?  -->\n\n<!-- Re: The odds ratio of a respondent minding about a close relative marring someone of a different religion are 3.1 times higher for Protestant respondents compared to Catholic ones. -->\n",
    "supporting": [
      "11-Answers_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}